/*! For license information please see 2.95290e1.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"/kZE":function(e,t,n){var a=n("LboF"),o=n("hXKb");"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};a(o,r);e.exports=o.locals||{}},"4+2x":function(e,t,n){"use strict";n("jS8O")},CncF:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"root"},[n("div",{class:{hidden:e.headVisible},attrs:{id:"headPanel"}},[n("span",{staticClass:"logo"},[e._v("Vue 生命周期图示")]),e._v(" "),n("button",{staticStyle:{background:"#1890FF",color:"#fff","border-radius":"5px","margin-left":"10px",cursor:"pointer"},on:{click:e.changeMode}},[e._v("\n      切换拖拽模式 ("+e._s(e.mode)+")\n    ")]),e._v(" "),n("router-link",{staticStyle:{float:"right","text-decoration":"underline",color:"#1890FF","font-size":"16px"},attrs:{to:{path:"/tree"}}},[e._v("\n      脑图\n    ")]),e._v(" "),n("i",{staticClass:"gb-toggle-btn",on:{click:function(t){e.headVisible=!e.headVisible}}})],1),e._v(" "),n("item-panel"),e._v(" "),n("div",{ref:"canvasPanel",attrs:{id:"canvasPanel"},on:{dragover:function(e){e.preventDefault()}}}),e._v(" "),n("div",{class:{hidden:!e.configVisible},attrs:{id:"configPanel"}},[n("i",{staticClass:"gb-toggle-btn",on:{click:function(t){e.configVisible=!e.configVisible}}}),e._v(" "),n("h2",{staticClass:"panel-title"},[e._v("数据配置")]),e._v(" "),n("div",{staticClass:"config-data"},[e._v("\n      id: "+e._s(e.config.id)+", data: "+e._s(e.config.data)+"\n    ")]),e._v(" "),n("h2",{staticClass:"panel-title"},[e._v("节点样式配置")]),e._v(" "),n("div",{staticClass:"config-data"},[n("div",{staticClass:"config-item"},[e._v("\n        形状: "),n("select",e._l(e.nodeShapes,(function(t,a){return n("option",{key:a,domProps:{value:t.shape}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),0)]),e._v(" "),n("div",{staticClass:"config-item"},[e._v("\n        背景色: "),n("input",{domProps:{value:e.node.fill}})]),e._v(" "),n("div",{staticClass:"config-item"},[e._v("\n        边框虚线: "),n("input",{domProps:{value:e.node.lineDash}})]),e._v(" "),n("div",{staticClass:"config-item"},[e._v("\n        边框颜色: "),n("input",{domProps:{value:e.node.borderColor}})]),e._v(" "),n("div",{staticClass:"config-item"},[e._v("\n        宽: "),n("input",{domProps:{value:e.node.width}}),e._v("px\n      ")]),e._v(" "),n("div",{staticClass:"config-item"},[e._v("\n        高: "),n("input",{domProps:{value:e.node.height}}),e._v("px\n      ")])]),e._v(" "),n("h2",{staticClass:"panel-title"},[e._v("文字样式配置")]),e._v(" "),n("div",{staticClass:"config-data"},[n("div",{staticClass:"config-item"},[e._v("\n        文字: "),n("input",{domProps:{value:e.label}})]),e._v(" "),n("div",{staticClass:"config-item"},[e._v("\n        字体大小: "),n("input",{domProps:{value:e.labelCfg.fontSize}})]),e._v(" "),n("div",{staticClass:"config-item"},[e._v("\n        颜色: "),n("input",{domProps:{value:e.labelCfg.style.fill}})])]),e._v(" "),n("button",{on:{click:function(t){e.configVisible=!1}}},[e._v("取消")]),e._v(" "),n("button",{staticClass:"save",on:{click:e.save}},[e._v("\n      保存\n    ")])]),e._v(" "),e.tooltip&&!e.isMouseDown?n("div",{staticClass:"g6-tooltip",style:"top: "+e.top+"px; left: "+e.left+"px;"},[e._v("\n    id: "+e._s(e.tooltip)+"\n  ")]):e._e()],1)};a._withStripped=!0;n("bHtr"),n("rGqo");var o=n("fD4D"),r=n("qlJx"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"itemPanel",class:{hidden:e.itemVisible},attrs:{id:"itemPanel"}},[n("i",{staticClass:"iconfont icon-h-drag"}),e._v(" "),n("div",{staticClass:"icon-tool"},[n("i",{staticClass:"node circle",attrs:{draggable:"true","data-label":"开始","data-shape":"circle-node",fill:"#eef5fe"}},[e._v("开始")]),e._v(" "),n("i",{staticClass:"node warning",attrs:{draggable:"true","data-label":"警告","data-shape":"rect-node",fill:"#f8ecda"}},[e._v("警告")]),e._v(" "),n("i",{staticClass:"node end",attrs:{draggable:"true","data-label":"结束","data-shape":"rect-node",fill:"#f9e3e2"}},[e._v("结束")]),e._v(" "),n("i",{staticClass:"node iconfont icon-circle",attrs:{draggable:"true","data-label":"圆形节点","data-shape":"circle-node"}}),e._v(" "),n("i",{staticClass:"node iconfont icon-rect",attrs:{draggable:"true","data-label":"方形节点","data-shape":"rect-node"}}),e._v(" "),n("i",{staticClass:"node iconfont icon-ellipse",attrs:{draggable:"true","data-label":"椭圆形节点","data-shape":"ellipse-node"}}),e._v(" "),n("i",{staticClass:"node iconfont icon-diamond",attrs:{draggable:"true","data-label":"菱形节点","data-shape":"diamond-node"}}),e._v(" "),n("i",{staticClass:"node iconfont icon-model-rect",attrs:{draggable:"true","data-label":"对话框节点","data-shape":"modelRect-node"}}),e._v(" "),n("i",{staticClass:"split"}),e._v(" "),n("i",{staticClass:"gb-toggle-btn",attrs:{draggable:"true"},on:{click:function(t){e.itemVisible=!e.itemVisible}}})])])};i._withStripped=!0;var s=n("dfwq"),l={name:"ItemPanel",data:function(){return{itemVisible:!1}},mounted:function(){Object(s.a)(this.$refs.itemPanel.querySelector(".icon-tool").querySelectorAll(".node")).forEach((function(e){e.addEventListener("dragstart",(function(t){var n=e.getAttribute("data-shape"),a=e.getAttribute("data-label"),o=e.getAttribute("fill");t.dataTransfer.setData("dragComponent",JSON.stringify({label:a,shape:n,fill:o}))}))})),document.addEventListener("drop",(function(e){e.preventDefault()}),!1)}},d=(n("4+2x"),n("KHd+")),c=Object(d.a)(l,i,[],!1,null,null,null);c.options.__file="src/pages/graph/ItemPanel.vue";var h=c.exports,g={nodes:[{id:"1",data:{action:"初始化"},x:500,y:100,style:{fill:"#39495b",lineDash:[1,2],shadowOffsetX:0,shadowOffsetY:2,shadowColor:"#666",shadowBlur:10,width:160,height:70},label:"new Vue()",labelCfg:{style:{fontSize:24,fill:"#fff",textAlign:"center",textBaseline:"middle",fontWeight:"bold"}},nodeStateStyles:{"nodeState:default":{fill:"#39495b"},"nodeState:hover":{fill:"#ffbd17"},"nodeState:selected":{fill:"#f1ac00"}},anchorPoints:[[0,0],[.5,0],[0,1],[.5,1],[1,0],[1,1]]},{id:"2",type:"circle-node",style:{r:50,width:230,height:60,fill:"#65b586",lineWidth:0},x:500,y:300,label:"初始化\n事件和生命周期",labelCfg:{style:{lineWidth:2,fontSize:18,stroke:"#ccc",fill:"#fff",textAlign:"center"}}},{id:"3",type:"rect-node",style:{fill:"#fff",stroke:"#c96164",lineWidth:3,width:180,height:60},x:250,y:170,label:"beforeCreate",labelCfg:{style:{fill:"#c96164",fontSize:20,fontWeight:"700",width:200,height:60}},anchorHotsoptStyles:{r:11,fill:"green"},anchorPointStyles:{r:4,fill:"#fff",stroke:"#1890FF",lineWidth:2}},{id:"4",x:500,y:450,type:"rect-node",label:"初始化\n注入 & 校验",style:{fill:"#65b586",size:[100,160],lineWidth:0},labelCfg:{style:{fontSize:12,fill:"#fff",stroke:"#65b586",textAlign:"left",x:-30,y:0}}},{id:"5",x:250,y:320,label:"created",type:"rect-node",style:{fill:"#fff",stroke:"#c96164",lineWidth:3,width:180,height:60},labelCfg:{style:{fontSize:20,fill:"#c96164"}}},{id:"6",x:500,y:600,type:"diamond-node",label:'是否指定 "el" 选项?',style:{size:[160,100],fill:"#f1b953",stroke:"#f1b953"},labelCfg:{style:{fontSize:14,fill:"#fff",stroke:"#f1b953"}}},{id:"7",x:750,y:600,label:"当调用\n vm.$mount(el)\n 函数时",style:{fill:"#65b586",size:[160,200],lineWidth:0},labelCfg:{style:{fill:"#fff",stroke:"#65b586",fontSize:12,textAlign:"left",x:-40,y:-30}},type:"triangle-node"},{x:500,y:800,id:"8",label:'是否指定 "template" 选项',labelCfg:{style:{fontSize:12}},style:{rx:100,ry:30},type:"ellipse-node"},{id:"9",x:250,y:800,label:"将 template 编译\n到 render 函数中",labelCfg:{style:{fontSize:12}},style:{width:160,height:60}},{id:"10",x:750,y:800,label:"将 el 外部的 HTML\n作为 template 编译",labelCfg:{style:{fontSize:12}},style:{width:160,height:60}},{id:"11",x:500,y:1e3,label:"结束",labelCfg:{style:{fontSize:16,fill:"#fff"}},style:{width:160,height:60,fill:"#fdbc33",lineWidth:0}}],edges:[{source:"1",target:"2",sourceAnchor:3,data:{type:"A",amount:"100,000 元",date:"2019-08-03"},label:"新建 Vue 实例",type:"cubic-edge",style:{stroke:"red",lineDash:[5,2],lineWidth:2,lineAppendWidth:10,cursor:"hand",endArrow:!0},labelCfg:{position:"center",autoRotate:!0,style:{stroke:"white",fill:"#722ed1",lineWidth:5}},edgeStateStyles:{"edgeState:default":{strokeOpacity:1,cursor:"default",lineDash:[5,2],lineWidth:2,lineAppendWidth:10,endArrow:!0},"edgeState:hover":{strokeOpacity:.6,cursor:"pointer"},"edgeState:selected":{strokeOpacity:1,cursor:"pointer"}}},{source:"1",target:"3",sourceAnchor:3,targetAnchor:4,data:{type:"B",amount:"100,000 元",date:"2019-08-03"},label:"",style:{endArrow:{path:"M 0,0 L 8,4 L 7,0 L 8,-4 Z",fill:"#aab7c1",stroke:"#aab7c1"}},edgeStateStyles:{"edgeState:default":{strokeOpacity:1,cursor:"default",endArrow:{path:"M 0,0 L 8,4 L 7,0 L 8,-4 Z",fill:"#aab7c1",stroke:"#aab7c1"}},"edgeState:hover":{strokeOpacity:.6,cursor:"pointer"},"edgeState:selected":{strokeOpacity:1,cursor:"pointer"}}},{source:"2",target:"4",data:{type:"C",amount:"100,000 元",date:"2019-08-03"},label:"",style:{endArrow:{path:o.a.Arrow.vee(),fill:"#aab7c1",stroke:"#aab7c1"}},edgeStateStyles:{"edgeState:default":{strokeOpacity:1,animate:!1,endArrow:{path:o.a.Arrow.vee(),fill:"#aab7c1",stroke:"#aab7c1"}},"edgeState:hover":{strokeOpacity:.6,stroke:"#ccc",animate:!0,animationType:"ball"},"edgeState:selected":{strokeOpacity:1,stroke:"#ccc"}}},{source:"2",target:"5",sourceAnchor:2,targetAnchor:1,data:{type:"C",amount:"100,000 元",date:"2019-08-03"},label:"准备",style:{endArrow:{path:o.a.Arrow.diamond(10,10,3),fill:"#aab7c1",stroke:"#aab7c1"}}},{source:"4",target:"6",data:{type:"B",amount:"100,000 元",date:"2019-08-03"},label:"继续",style:{endArrow:{path:o.a.Arrow.rect(10,10,3),fill:"#aab7c1",stroke:"#aab7c1"}}},{source:"6",target:"7",data:{type:"C",amount:"100,000 元",date:"2019-08-03"}},{source:"6",target:"8",data:{type:"C",amount:"100,000 元",date:"2019-08-03"}},{source:"8",target:"9",data:{type:"C",amount:"100,000 元",date:"2019-08-03"}},{source:"8",target:"10",data:{type:"C",amount:"100,000 元",date:"2019-08-03"}},{source:"9",target:"11",data:{type:"C",amount:"100,000 元",date:"2019-08-03"}},{source:"10",target:"11",data:{type:"C",amount:"100,000 元",date:"2019-08-03"}}]},f={components:{ItemPanel:h},data:function(){return{mode:"drag-shadow-node",graph:{},highLight:{undo:!1,redo:!1},lineStyle:{type:"line",width:1},label:"",labelCfg:{fontSize:12,style:{fill:"#fff"}},node:{fill:"",lineDash:"none",borderColor:"",width:160,height:60,shape:"rect-node"},nodeShapes:[{name:"矩形",shape:"rect-node"},{name:"圆形",shape:"circle-node"},{name:"椭圆",shape:"ellipise-node"},{name:"菱形",shape:"diamond-node"}],headVisible:!1,configVisible:!1,isMouseDown:!1,config:"",tooltip:"",top:0,left:0}},mounted:function(){var e=this;this.$nextTick((function(){e.createGraphic(),e.initGraphEvent()}))},beforeDestroy:function(){this.graph.destroy()},methods:{createGraphic:function(){var e=this,t=new o.a.Grid,n=new o.a.Menu({offsetX:-20,offsetY:-50,itemTypes:["node","edge"],getContent:function(e){var t=document.createElement("div");return t.style.width="80px",t.style.cursor="pointer",t.innerHTML='<p id="deleteNode">删除节点</p>',t},handleMenuClick:function(t,n){var a=t.id;a&&e[a](n)}}),a=new o.a.Minimap({size:[200,100]}),i=Object(r.a)(o.a,{width:window.innerWidth,height:window.innerHeight,layout:{type:""},defaultNode:{type:"rect-node",style:{radius:10,width:100,height:50,cursor:"move",fill:"#ecf3ff"},labelCfg:{fontSize:20,style:{cursor:"move"}}},defaultEdge:{type:"polyline-edge",style:{radius:5,offset:15,stroke:"#aab7c3",lineAppendWidth:10,endArrow:!0}},nodeStateStyles:{"nodeState:default":{opacity:1},"nodeState:hover":{opacity:.8},"nodeState:selected":{opacity:.9}},edgeStateStyles:{"edgeState:default":{stroke:"#aab7c3"},"edgeState:selected":{stroke:"#1890FF"},"edgeState:hover":{animate:!0,animationType:"dash",stroke:"#1890FF"}},modes:{default:["drag-canvas","drag-shadow-node","canvas-event","delete-item","select-node","hover-node","active-edge"],originDrag:["drag-canvas","drag-node","canvas-event","delete-item","select-node","hover-node","active-edge"]},plugins:[n,a,t]});this.graph=new o.a.Graph(i),this.graph.read(g)},initGraphEvent:function(){var e=this;this.graph.on("drop",(function(t){var n=t.originalEvent;if(n.dataTransfer){var a=n.dataTransfer.getData("dragComponent");a&&e.addNode(a,t)}})),this.graph.on("node:drop",(function(e){e.item.getOutEdges().forEach((function(e){e.clearStates("edgeState")}))})),this.graph.on("after-node-selected",(function(t){if(e.configVisible=!!t,t&&t.item){var n=t.item.get("model");e.config=n,e.label=n.label,e.labelCfg={fontSize:n.labelCfg.fontSize,style:{fill:n.labelCfg.style.fill}},e.node={fill:n.style.fill,borderColor:n.style.stroke,lineDash:n.style.lineDash||"none",width:n.style.width,height:n.style.height,shape:n.type}}})),this.graph.on("on-node-mouseenter",(function(e){e&&e.item&&e.item.getOutEdges().forEach((function(e){e.clearStates("edgeState"),e.setState("edgeState","hover")}))})),this.graph.on("mousedown",(function(t){e.isMouseDown=!0})),this.graph.on("mouseup",(function(t){e.isMouseDown=!1})),this.graph.on("canvas:mouseleave",(function(t){e.graph.getNodes().forEach((function(e){e.getContainer().clearAnchor(),e.clearStates("anchorActived")}))})),this.graph.on("on-node-mousemove",(function(t){t&&t.item&&(e.tooltip=t.item.get("model").id,e.left=t.clientX+40,e.top=t.clientY-20)})),this.graph.on("on-node-mouseleave",(function(t){t&&t.item&&(e.tooltip="",t&&t.item&&t.item.getOutEdges().forEach((function(e){e.clearStates("edgeState")})))})),this.graph.on("before-node-removed",(function(e){e.target;var t=e.callback;setTimeout((function(){t(!0)}),1e3)})),this.graph.on("after-node-dblclick",(function(e){e&&e.item})),this.graph.on("after-edge-selected",(function(t){e.configVisible=!!t,t&&t.item&&(e.config=t.item.get("model").id,e.graph.updateItem(t.item,{style:{radius:10,lineWidth:2}}))})),this.graph.on("on-edge-mousemove",(function(t){t&&t.item&&(e.tooltip=t.item.get("model").label,e.left=t.clientX+40,e.top=t.clientY-20)})),this.graph.on("on-edge-mouseleave",(function(t){t&&t.item&&(e.tooltip="")})),this.graph.on("before-edge-add",(function(t){var n=t.source,a=t.target,o=t.sourceAnchor,r=t.targetAnchor;setTimeout((function(){e.graph.addItem("edge",{id:"".concat(+new Date+(1e4*Math.random()).toFixed(0)),source:n.get("id"),target:a.get("id"),sourceAnchor:o,targetAnchor:r})}),100)}))},changeMode:function(){"drag-node"===this.mode?(this.mode="drag-shadow-node",this.graph.setMode("default")):(this.mode="drag-node",this.graph.setMode("originDrag"))},deleteNode:function(e){this.graph.removeItem(e)},addNode:function(e,t){var n=t.x,a=t.y,o=JSON.parse(e),r={label:o.label,type:o.shape,style:{fill:o.fill||"#ecf3ff"},x:n,y:a};this.graph.addItem("node",r)},save:function(){window.alert("我觉得就算我不写你也会了")}}},u=(n("eGKd"),Object(d.a)(f,a,[],!1,null,null,null));u.options.__file="src/pages/graph/graph.vue";t.default=u.exports},DxD1:function(e,t,n){(t=n("JPst")(!1)).push([e.i,"#itemPanel{position:absolute;top:0;left:0;bottom:0;z-index:10;width:100px;background:#fff;padding-top:65px;-webkit-transition:-webkit-transform .3s ease-in-out;transition:-webkit-transform .3s ease-in-out;-o-transition:transform .3s ease-in-out;transition:transform .3s ease-in-out;transition:transform .3s ease-in-out, -webkit-transform .3s ease-in-out;-webkit-box-shadow:0 0 2px 0 rgba(0,0,0,.1);box-shadow:0 0 2px 0 rgba(0,0,0,.1)}#itemPanel.hidden{-webkit-transform:translate(-100%, 0);-ms-transform:translate(-100%, 0);transform:translate(-100%, 0)}#itemPanel .icon-h-drag{position:absolute;top:40px;left:0;width:100%;height:20px;line-height:20px;font-size:18px;background:#f5f5f5;text-align:center;cursor:move}#itemPanel .icon-h-drag:hover{background:#f1f1f1}#itemPanel .gb-toggle-btn{width:10px;height:20px;top:50%;left:100%;border-radius:0 10px 10px 0;-webkit-box-shadow:2px 0 2px 0 rgba(0,0,0,.1);box-shadow:2px 0 2px 0 rgba(0,0,0,.1);-webkit-transform:translate(0, -50%);-ms-transform:translate(0, -50%);transform:translate(0, -50%)}#itemPanel .split{height:1px;display:block;background:#e0e0e0;margin:5px 0}#itemPanel .icon-tool{padding:10px;text-align:center}#itemPanel .icon-tool .iconfont{display:block;width:40px;height:40px;line-height:40px;font-size:30px;cursor:move;border:1px solid transparent;margin:0 auto}#itemPanel .icon-tool .iconfont:hover{border-color:#ccc}#itemPanel .icon-tool .node{display:block;margin-bottom:10px;cursor:move}#itemPanel .icon-tool .circle{height:80px;line-height:80px;border-radius:50%;border:1px solid #ccc;background:#eef5fe}#itemPanel .icon-tool .warning{height:40px;line-height:40px;border-left:4px solid #e6a23c;background:#f8ecda}#itemPanel .icon-tool .end{height:40px;line-height:40px;border-radius:10px;background:#f9e3e2}",""]),e.exports=t},Nr18:function(e,t,n){"use strict";var a=n("S/j/"),o=n("d/Gc"),r=n("ne8i");e.exports=function(e){for(var t=a(this),n=r(t.length),i=arguments.length,s=o(i>1?arguments[1]:void 0,n),l=i>2?arguments[2]:void 0,d=void 0===l?n:o(l,n);d>s;)t[s++]=e;return t}},bHtr:function(e,t,n){var a=n("XKFU");a(a.P,"Array",{fill:n("Nr18")}),n("nGyu")("fill")},eGKd:function(e,t,n){"use strict";n("/kZE")},hXKb:function(e,t,n){(t=n("JPst")(!1)).push([e.i,".g6-tooltip{position:fixed;top:0;left:0;font-size:12px;color:#545454;border-radius:4px;border:1px solid #e2e2e2;background-color:rgba(255,255,255,.9);-webkit-box-shadow:#aeaeae 0 0 10px;box-shadow:#aeaeae 0 0 10px;padding:10px 8px}.g6-minimap{position:absolute;right:0;bottom:0;background:#fff}",""]),e.exports=t},jS8O:function(e,t,n){var a=n("LboF"),o=n("DxD1");"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};a(o,r);e.exports=o.locals||{}},qlJx:function(e,t,n){"use strict";n("jm62"),n("RW0V"),n("f3/d"),n("Z2Ku"),n("dRSK"),n("rGqo");var a=n("vYYK");n("Vd3H");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n,a){e.attr(t),n&&n.attr(a)}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hover",a=t.get("item"),o=t.getFirst().attr(),r="node"===e?a.get("originStyle"):a.get("originStyle")["edge-shape"],i=o["".concat(e,"State:").concat(n)],s=o["".concat(e,"State:default")];return"edge"===e&&s&&null==s.lineWidth&&(s.lineWidth=1),{activeStyle:i,defaultStyle:s,originStyle:r}}var l={anchorShow:function(e,t){if(t.get("children")){var n=t.get("children")[0].cfg.attrs.anchorControls;if(n&&n.hide)return!1}e?t.showAnchor(t):t.clearAnchor(t)},anchorActived:function(e,t){if(t.get("children")){var n=t.get("children")[0].cfg.attrs.anchorControls;if(n&&n.hide)return!1}if(e){var a=t.get("item").getModel(),o=a.anchorPoints,i=a.anchorHotsoptStyles;t.showAnchor(t),this.getAnchorPoints({anchorPoints:o}).forEach((function(e,n){var a=t.get("children")[0].getBBox(),o=t.addShape("circle",{zIndex:0,attrs:r({x:a.minX+a.width*e[0],y:a.minY+a.height*e[1],r:0,opacity:.5,fill:"#1890ff"},i),nodeId:t.get("item").get("id"),className:"node-anchor-bg",draggable:!0,isAnchor:!0,index:n});o.animate({r:11},{duration:200}),t.sort(),t.anchorShapes.push(o)})),t.anchorShapes.filter((function(e){"node-anchor"===e.get("className")&&e.toFront(),"node-anchor-group"===e.get("className")&&(e.attr({r:(i&&i.r||11)+2}),e.toFront())}))}else t.clearAnchor(t)},nodeState:function(e,t){!1===e?l["nodeState:default"].call(this,!0,t):l["nodeState:".concat(e)]&&l["nodeState:".concat(e)].call(this,e,t)},"nodeState:default":function(e,t){if(e){var n=t.getChildByIndex(0),a=t.getChildByIndex(1),o=s.call(this,"node",t).defaultStyle;if(!o)return;i(n,o,a,o.labelCfg&&o.labelCfg.style?o.labelCfg.style:{})}},"nodeState:selected":function(e,t){var n=t.getChildByIndex(0),a=t.getChildByIndex(1),o=s.call(this,"node",t,"selected"),r=o.activeStyle,l=o.defaultStyle;r&&(e?i(n,r,a,r.labelCfg&&r.labelCfg.style?r.labelCfg.style:{}):i(n,l,a,l.labelCfg&&l.labelCfg.style?l.labelCfg.style:{}))},"nodeState:hover":function(e,t){var n=t.getChildByIndex(0),a=s.call(this,"node",t,"hover"),o=a.activeStyle,r=a.defaultStyle;o&&i(n,e?o:r)},edgeState:function(e,t){!1===e?l["edgeState:default"].call(this,!0,t):l["edgeState:".concat(e)]&&l["edgeState:".concat(e)].call(this,e,t)},"edgeState:default":function(e,t){if(e){var n=s.call(this,"edge",t),a=n.activeStyle,o=n.defaultStyle,l=n.originStyle,d=t.getChildByIndex(0),c=d.get("attrs"),h=c.endArrow,g=c.startArrow;o&&(this.stopAnimate(t,a&&a.animationType?a.animationType:"dash"),i(d,r(r({},o),{},{animationType:a.animationType||"dash"})),h&&d.attr("endArrow",!0===h||{path:h.path,fill:o.stroke||l.stroke}),g&&d.attr("startArrow",!0===g||{path:g.path,fill:o.stroke||l.stroke}))}},"edgeState:hover":function(e,t){var n=t.getChildByIndex(0),a=n.get("attrs"),o=a.endArrow,r=a.startArrow,l=s.call(this,"edge",t,"hover"),d=l.activeStyle,c=l.defaultStyle,h=l.originStyle;d&&(e?!0===d.animate?this.runAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t):(i(n,d),o&&n.attr("endArrow",!0===o||{path:o.path,fill:d.stroke||h.stroke}),r&&n.attr("startArrow",!0===r||{path:r.path,fill:d.stroke||h.stroke})):!0===d.animate?this.stopAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t,"stop"):(i(n,c),o&&n.attr("endArrow",!0===o||{path:o.path,fill:c.stroke||d.stroke||h.stroke}),r&&n.attr("startArrow",!0===r||{path:r.path,fill:c.stroke||d.stroke||h.stroke})))},"edgeState:selected":function(e,t){var n=t.getChildByIndex(0),a=n.get("attrs"),o=a.endArrow,r=a.startArrow,l=s.call(this,"edge",t,"selected"),d=l.activeStyle,c=l.defaultStyle,h=l.originStyle;d&&(e?!0===d.animate?this.runAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t):(i(n,d),o&&n.attr("endArrow",!0===o||{path:o.path,fill:d.stroke||h.stroke}),r&&n.attr("startArrow",!0===r||{path:r.path,fill:d.stroke||h.stroke})):!0===d.animate?this.stopAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t,"stop"):(i(n,c),o&&n.attr("endArrow",!0===o||{path:o.path,fill:c.stroke||d.stroke||h.stroke}),r&&n.attr("startArrow",!0===r||{path:r.path,fill:c.stroke||d.stroke||h.stroke})))}},d=l,c=n("dfwq"),h=[],g=null,f={fill:"#ecf3ff",stroke:"#1890FF",lineWidth:1},u={style:{fontSize:12,fill:"#666",textAlign:"center",textBaseline:"middle",cursor:"default"}},p={width:20,height:20,x:0,y:0},y={r:4,fill:"#fff",stroke:"#1890FF",lineWidth:1};function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=p,S=f,x=y,w=u;function O(e,t){return m(m(m(m(m(m({},t),S),e),t.style),{},{labelCfg:m(m({},w),t.labelCfg),iconStyles:m(m({},v),t.iconStyles),anchorPointStyles:m(m({},x),t.anchorPointStyles)},t.nodeStateStyles),{},{anchorHotsoptStyles:t.anchorHotsoptStyles})}var k=function(e){e.registerNode("base-node",{getShapeStyle:function(e){var t=e.style.width||80,n=e.style.height||40;return O.call(this,{width:t,height:n,radius:5,x:-t/2,y:-n/2},e)},drawIcon:function(e,t,n){[n.logoIcon,n.stateIcon].forEach((function(e,a){if(e){var o="".concat(n.type,"-").concat(0===a?"logoIcon":"stateIcon"),r=t.$getItem(o);if(!r)t.addShape(e.img?"image":"text",{attrs:m(m({},e),e.style),draggable:!0,className:o}).toFront(),r=t.$getItem(o);r&&(e.show?r.show():r.hide())}}))},initAnchor:function(e,t){var n=this;t.anchorShapes=[],t.showAnchor=function(){n.drawAnchor(e,t)},t.clearAnchor=function(){if(t.anchorShapes){var e=t.$getItem("dashed-line");e&&e.remove(),t.anchorShapes.forEach((function(e){return e.remove()}))}t.anchorShapes=[]}},drawAnchor:function(e,t){var n=t.getFirst().attr(),a=n.type,o=n.direction,r=n.anchorPointStyles,i=t.get("children")[0].getBBox(),s=this.getAnchorPoints(e);s&&s.forEach((function(e,n){var s="triangle-node"===a?"up"===o?1:0:.5,l=i.width*(e[0]-.5),d=i.height*(e[1]-s),f=t.addShape("circle",{attrs:m({x:l,y:d},r),zIndex:1,nodeId:t.get("id"),className:"node-anchor",draggable:!0,isAnchor:!0,index:n}),u=t.addShape("circle",{attrs:{x:l,y:d,r:11,fill:"#000",opacity:0},zIndex:2,nodeId:t.get("id"),className:"node-anchor-group",draggable:!0,isAnchor:!0,index:n});!function(e,t,n){e.on("mouseenter",(function(){e.attr({cursor:"crosshair"})})),e.on("dragstart",(function(e){var a=t.getFirst().attr(),o=a.type,r=a.direction,i="triangle-node"===o?"up"===r?1:0:.5,s=t.get("item").getBBox(),l=t.get("item").get("id"),d=[s.width*(n[0]-.5),s.height*(n[1]-i)];h=[e.x,e.y];var c=t.addShape("path",{attrs:{stroke:"#1890FF",lineDash:[5,5],path:[["M"].concat(d),["L"].concat(d)]},className:"dashed-line",pointStart:d});t.toFront(),c.toFront(),g=l})),e.on("drag",(function(e){var n=t.$getItem("dashed-line"),a=t.getFirst().attr(),o=a.type,r=a.direction,i=t.get("children")[0].get("canvasBBox");if(i&&n){var s="triangle-node"===o?"up"===r?i.height:0:i.height/2,l=n.get("pointStart"),d=[e.x-i.x-i.width/2,e.y-i.y-s];n.toFront(),Math.sqrt(Math.pow(Math.abs(h[0])-Math.abs(e.x),2)+Math.pow(Math.abs(h[1])-Math.abs(e.y),2))>=10&&(e.x>=h[0]?(e.y,h[1],d[0]-=1,d[1]-=1):(e.y,h[1],d[0]+=1,d[1]+=1)),n.attr({path:[["M"].concat(Object(c.a)(l)),["L",d[0],d[1]]]})}})),e.on("dragend",(function(e){t.$getItem("dashed-line").remove(),g=null})),e.on("dragenter",(function(e){if(e.target.cfg.nodeId!==g){var n=e.target.cfg.index;t.getAllAnchorBg()[n]&&t.getAllAnchorBg()[n].attr("fillOpacity",.7)}})),e.on("dragleave",(function(e){if(e.target.cfg.nodeId!==g){var n=e.target.cfg.index;t.getAllAnchorBg()[n]&&t.getAllAnchorBg()[n].attr("fillOpacity",.5)}}))}(u,t,e),t.anchorShapes.push(f),t.anchorShapes.push(u)})),t.getAllAnchors=function(){return t.anchorShapes.filter((function(e){return!0===e.get("isAnchor")}))},t.getAnchor=function(e){return t.anchorShapes.filter((function(t){return"node-anchor"===t.get("className")&&t.get("index")===e}))},t.getAllAnchorBg=function(){return t.anchorShapes.filter((function(e){return"node-anchor-bg"===e.get("className")}))}},addLabel:function(e,t,n){var a=n.label,o=n.labelCfg,r=n.labels;if(r)r.forEach((function(e){var n=e.label,a=e.labelCfg.maxlength,o=e.className,r=a?n.substr(0,a):n||"";n.length>a&&(r="".concat(r,"...")),t.addShape("text",{attrs:m(m(m({text:r},e),e.labelCfg),e.labelCfg.style),className:"node-text ".concat(o),draggable:!0})}));else if(a){var i=o.maxlength,s=i?a.substr(0,i):a||"";a.length>i&&(s="".concat(s,"...")),t.addShape("text",{attrs:m(m({text:s,x:0,y:0},o),o.style),className:"node-text",draggable:!0})}},drawModelRect:function(e,t){var n=t.preRect,a=t.width,o=t.height;n&&!1===n.show||e.addShape("rect",{attrs:m(m({x:-a/2,y:-o/2,height:o},{show:!0,width:4,fill:"#40a9ff",radius:2}),n),draggable:!0})},draw:function(e,t){return this.drawShape(e,t)},drawShape:function(e,t){var n=this.getShapeStyle(e,t),a=t.addShape(this.shapeType,{className:"".concat(this.shapeType,"-shape"),xShapeNode:!0,draggable:!0,attrs:n});return t.$getItem=function(e){return t.get("children").find((function(t){return t.get("className")===e}))},"modelRect-node"===this.type&&this.drawModelRect(t,n),this.addLabel(e,t,n),this.drawIcon(e,t,n),this.initAnchor(e,t),a},update:function(e,t){var n=t.get("model"),a=t.get("keyShape").attrs,o=t.get("group"),r=o.$getItem("node-text"),i=o.get("children")[0];if(r&&r.attr(m({text:n.label},n.labelCfg.style)),"diamond-node"===a.type){var s=this.getPath({style:{size:n.size}});i.attr(m(m(m({},a),n.style),{},{path:s,width:n.size[0],height:n.size[1]}))}else i.attr(m(m({},a),n.style))},setState:function(e,t,n){var a=n.getContainer();a.get("destroyed")||(["anchorShow","anchorActived","nodeState","nodeState:default","nodeState:selected","nodeState:hover","nodeOnDragStart","nodeOnDrag","nodeOnDragEnd"].includes(e)?d[e].call(this,t,a):this.stateApplying&&this.stateApplying.call(this,e,t,n))},getAnchorPoints:function(e){return e.anchorPoints||[[.5,0],[1,.5],[.5,1],[0,.5]]}},"single-node")};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=p,j=f,_=y,D=u;function E(e,t){return A(A(A(A(A(A({},t),j),e),t.style),{},{labelCfg:A(A(A({},D),t.labelCfg),{},{style:A(A({},D.style),t.labelCfg?t.labelCfg.style:{})}),iconStyles:A(A({},P),t.iconStyles),anchorPointStyles:A(A({},_),t.anchorPointStyles)},t.nodeStateStyles),{},{anchorHotsoptStyles:t.anchorHotsoptStyles})}var M=function(e){k(e),function(e){e.registerNode("rect-node",{shapeType:"rect",getShapeStyle:function(e){var t=e.style.width||80,n=e.style.height||40;return E.call(this,{width:t,height:n,radius:5,x:-t/2,y:-n/2},e)}},"base-node"),e.registerNode("circle-node",{shapeType:"circle",getShapeStyle:function(e){var t=e.style.r||30;return E.call(this,{r:t,x:0,y:0},e)}},"base-node"),e.registerNode("ellipse-node",{shapeType:"ellipse",getShapeStyle:function(e){return E.call(this,{rx:50,ry:30,x:0,y:0},e)}},"base-node"),e.registerNode("modelRect-node",{shapeType:"rect",getShapeStyle:function(e){var t=e.style.width||200,n=e.style.height||80;return E.call(this,{width:t,height:n,radius:5,x:-t/2,y:-n/2},e)}},"base-node"),e.registerNode("diamond-node",{shapeType:"path",getShapeStyle:function(e){var t=this.getPath(e);return E.call(this,{path:t,x:0,y:0},e)},getPath:function(e){var t=e.style.size||[100,100],n=t[0],a=t[1];return[["M",0,-a/2],["L",n/2,0],["L",0,a/2],["L",-n/2,0],["Z"]]}},"base-node"),e.registerNode("triangle-node",{shapeType:"path",getShapeStyle:function(e){var t=this.getPath(e);return E.call(this,{direction:e.direction||"up",path:t,x:0,y:0},e)},getPath:function(e){var t=e.direction||"up",n=e.style.size||[60,100],a=n[0],o=n[1],r=[["Z"]];return"up"===t?r.unshift(["M",0,-o/2],["L",-a/2,0],["L",a/2,0]):r.unshift(["M",0,o/2],["L",-a/2,0],["L",a/2,0]),r},getAnchorPoints:function(e){return e.anchorPoints||[[.5,0],[0,1],[1,1]]}},"base-node")}(e)};n("L9s1");function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){!function(e){e.registerBehavior("canvas-event",{getDefaultCfg:function(){return{}},shouldBegin:function(e){return!0},getEvents:function(){return{"canvas:mousemove":"onCanvasMouseMove","canvas:mousedown":"onCanvasMouseDown","canvas:mouseup":"onCanvasMouseUp","canvas:dragend":"onCanvasDragEnd"}},onCanvasMouseMove:function(e){e.target.get("el").style.cursor="grab"},onCanvasMouseDown:function(e){e.target.get("el").style.cursor="grabbing"},onCanvasMouseUp:function(e){e.target.get("el").style.cursor="grab"},onCanvasDragEnd:function(e){e.target.get("el").style.cursor="grab",this.graph.emit("on-canvas-dragend",e)}})}(e),function(e){e.registerBehavior("select-node",{getDefaultCfg:function(){return{multiple:!1}},getEvents:function(){return{"node:click":"onNodeClick","node:dblclick":"ondblClick","canvas:click":"onCanvasClick","node:mouseenter":"onNodeMouseEnter","node:mousemove":"onNodeMouseMove","node:mouseleave":"onNodeMouseLeave"}},shouldBegin:function(e){return!0},onNodeClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.toFront(),e.item.setState("nodeState","selected"),this.graph.emit("after-node-selected",e))},ondblClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.toFront(),e.item.setState("nodeState","selected"),this.graph.emit("after-node-dblclick",e))},onCanvasClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),this.graph.emit("on-canvas-click",e))},onNodeMouseEnter:function(e){this.shouldBegin(e)&&(e.item.hasState("nodeState:selected")||e.item.setState("nodeState","hover"),this.graph.emit("on-node-mouseenter",e))},onNodeMouseMove:function(e){this.shouldBegin(e)&&this.graph.emit("on-node-mousemove",e)},onNodeMouseLeave:function(e){this.shouldBegin(e)&&(e.item.hasState("nodeState:selected")||e.item.clearStates("nodeState:hover"),this.graph.emit("on-node-mouseleave",e))},_clearSelected:function(){this.graph.findAllByState("node","nodeState:selected").forEach((function(e){e.clearStates(["nodeState:selected","nodeState:hover"])})),this.graph.findAllByState("edge","edgeState:selected").forEach((function(e){e.clearStates(["edgeState:selected","edgeState:hover"])})),this.graph.emit("after-node-selected")}})}(e),function(e){e.registerBehavior("delete-item",{getEvents:function(){return{keydown:"onKeydown"}},shouldBegin:function(e){return!0},onKeydown:function(e){var t=this.graph;if("true"===t.cfg.canvas.cfg.el.getAttribute("isFocused")&&this.shouldBegin(e)&&(8===e.keyCode||46===e.keyCode)){var n=t.findAllByState("node","nodeState:selected");if(n&&n.length){var a=n[0].getContainer().get("item");t.emit("before-node-removed",{target:a,callback:function(e){e&&(t.remove(a),t.set("after-node-selected",[]),t.emit("after-node-selected"),t.emit("after-node-removed",a))}})}var o=t.findAllByState("edge","edgeState:selected");if(o&&o.length){var r=o[0].getContainer().get("item");t.emit("before-edge-removed",{target:r,callback:function(e){e&&(t.remove(r),t.set("after-edge-selected",[]),t.emit("after-edge-selected"),t.emit("after-edge-removed",r))}})}}}})}(e),function(e){e.registerBehavior("active-edge",{getDefaultCfg:function(){return{}},getEvents:function(){return{"canvas:click":"onCanvasClick","edge:click":"onEdgeClick","edge:dblclick":"ondblEdgeClick","edge:mouseenter":"onMouseEnter","edge:mousemove":"onMouseMove","edge:mouseleave":"onMouseLeave"}},shouldBegin:function(e){return!0},onCanvasClick:function(e){this._clearSelected()},onEdgeClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.setState("edgeState","selected"),this.graph.emit("after-edge-selected",e))},ondblEdgeClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.setState("edgeState","selected"),this.graph.emit("after-edge-dblclick",e))},onMouseEnter:function(e){this.shouldBegin(e)&&(e.item.hasState("edgeState:hover")||e.item.hasState("edgeState:selected")||e.item.setState("edgeState","hover"),this.graph.emit("on-edge-mouseenter",e))},onMouseMove:function(e){this.shouldBegin(e)&&this.graph.emit("on-edge-mousemove",e)},onMouseLeave:function(e){this.shouldBegin(e)&&(e.item.hasState("edgeState:selected")||e.item.setState("edgeState","default"),this.graph.emit("on-edge-mouseleave",e))},_clearSelected:function(){this.graph.findAllByState("node","nodeState:selected").forEach((function(e){e.clearStates("nodeState:selected")})),this.graph.findAllByState("edge","edgeState:selected").forEach((function(e){e.clearStates("edgeState:selected")})),this.graph.emit("after-edge-selected")}})}(e),function(e){e.registerBehavior("hover-node",{getEvents:function(){return{"node:mouseenter":"onNodeEnter","node:mouseleave":"onNodeLeave"}},shouldBegin:function(e){return!0},onNodeEnter:function(e){this.shouldBegin(e)&&e.item.setState("anchorShow",!0)},onNodeLeave:function(e){this.shouldBegin(e)&&e.item.setState("anchorShow",!1)}})}(e),function(e){e.registerBehavior("drag-shadow-node",{getDefaultCfg:function(){return{isGragging:!1,sourceAnchorIndex:0,dragTarget:"node",dragStartNode:{},distance:[]}},getEvents:function(){return{"node:mousedown":"onMousedown","node:mouseup":"onMouseup","node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd","node:drop":"onDrop"}},shouldBegin:function(e){return!0},onMousedown:function(e){if(this.shouldBegin(e)){if(this._clearSelected(e),e.target.cfg.isAnchor)this.dragTarget="anchor",this.dragStartNode=N(N({},e.item._cfg),{},{anchorIndex:e.target.cfg.index}),this.graph.findAll("node",(function(e){return e})).forEach((function(e){e.setState("anchorActived",!0)}));this.graph.emit("on-node-mousedown",e)}},onMouseup:function(e){if(this.shouldBegin(e)){if("anchor"===this.dragTarget)this.graph.findAll("node",(function(e){return e})).forEach((function(e){e.clearStates("anchorActived")}));this.graph.emit("on-node-mouseup",e)}},onDragStart:function(e){if(this.shouldBegin(e)){var t=e.item.getContainer();this.isGragging=!0,this.origin={x:e.x,y:e.y},e.target.get("isAnchor")?this.sourceAnchorIndex=e.target.get("index"):t.getFirst().cfg.xShapeNode&&(e.item.toFront(),this.dragTarget="node",this._nodeOnDragStart(e,t)),this.graph.emit("on-node-dragstart",e)}},onDrag:function(e){if(this.shouldBegin(e)&&this.isGragging){var t=e.item.getContainer();"node"===this.dragTarget&&t.getFirst().cfg.xShapeNode&&this._nodeOnDrag(e,e.item.getContainer()),this.graph.emit("on-node-drag",e)}},onDragEnd:function(e){if(this.shouldBegin(e)){var t=e.item.getContainer();if(this.isGragging=!1,"anchor"===this.dragTarget)this.graph.findAll("node",(function(e){return e})).forEach((function(e){e.clearStates("anchorActived")}));else"node"===this.dragTarget&&t.getFirst().cfg.xShapeNode&&this._nodeOnDragEnd(e,t);this.graph.emit("on-node-dragend",e)}},onDrop:function(e){var t=this;if(this.shouldBegin(e)){if(this.dragStartNode.id&&e.target.cfg.isAnchor&&this.dragStartNode.id!==e.target.cfg.nodeId){var n=this.dragStartNode.group.get("item"),a=n.getModel().singleEdge,o=e.target.get("index");n.getOutEdges().find((function(r){if(r.get("source").get("id")===n.get("id")&&r.get("target").get("id")===e.target.cfg.nodeId&&r.get("sourceAnchorIndex")===t.sourceAnchorIndex&&r.get("targetAnchorIndex")===o||a&&r.get("target").get("id")===e.target.cfg.nodeId)return!0}))||this.graph.emit("before-edge-add",{source:n,target:e.item.getContainer().get("item"),sourceAnchor:this.dragStartNode.anchorIndex,targetAnchor:e.target.cfg.index})}this.graph.emit("on-node-drop",e)}},_dragNodeModeCheck:function(){return!!this.graph.get("modes")[this.graph.getCurrentMode()].includes("drag-node")},_nodeOnDragStart:function(e,t){this._dragNodeModeCheck(),this._addShadowNode(e,t)},_addShadowNode:function(e,t){var n=t.get("item"),a=n.get("model"),o=n.get("originStyle").radius,r=n.get("currentShape"),i=n.getBBox(),s=i.width,l=i.height,d=i.centerX,c=i.centerY,h=(n.get("shapeFactory")[r]||{}).shapeType,g={fillOpacity:.1,fill:"#1890FF",stroke:"#1890FF",cursor:"move",lineDash:[4,4],width:s,height:l,x:a.x,y:a.y};switch(h){case"circle":this.distance=[e.x-d,e.y-c],g=N(N({},g),{},{r:s/2});break;case"rect":this.distance=[e.x-d+s/2,e.y-c+l/2],g=N(N({},g),{},{x:-s/2,y:-l/2,r:s/2}),o&&(g.radius=o);break;case"ellipse":this.distance=[e.x-d,e.y-c],g=N(N({},g),{},{rx:s/2,ry:l/2});break;case"path":this.distance=[e.x-d,e.y-c],g.path=n.get("keyShape").attrs.path,g.size=[s,l];break;case"modelRect":this.distance=[e.x-d+s/2,e.y-c+l/2],g=N(N({},g),{},{x:-s/2,y:-l/2,r:s/2}),h="rect";break;default:h="circle"}t.addShape(h,{className:"shadow-node",attrs:g}).toFront()},_nodeOnDrag:function(e,t){var n=t.get("item"),a=t.getFirst(),o=n.getBBox(),r=o.width,i=o.height,s=o.centerX,l=o.centerY,d=a.cfg.xShapeNode?t.$getItem("shadow-node"):null,c=(n.get("shapeFactory")[n.get("currentShape")]||{}).shapeType;if(d){if("path"===c){var h=a.get("attrs"),g=h.type,f=h.direction,u=e.x-s-this.distance[0],p=e.y-l-this.distance[1],y=[["Z"]];switch(g){case"diamond-node":y.unshift(["M",u,p-i/2],["L",u+r/2,p],["L",u,p+i/2],["L",u-r/2,p]);break;case"triangle-node":y.unshift(["L",u+r/2,p],["L",u-r/2,p]),"up"===f?y.unshift(["M",u,p-i]):y.unshift(["M",u,p+i])}d.attr({path:y})}else d.attr({x:e.x-s-this.distance[0],y:e.y-l-this.distance[1]});d.toFront()}},_nodeOnDragEnd:function(e,t){var n=this.graph,a=e.item.getModel(),o=t.getFirst().cfg.xShapeNode?t.$getItem("shadow-node"):null;if(o){var r={x:e.x-this.origin.x+a.x,y:e.y-this.origin.y+a.y};o.remove(),this._dragNodeModeCheck()||n.updateItem(e.item,r)}},_clearSelected:function(e){this.graph.findAllByState("edge","edgeState:selected").forEach((function(e){e.clearStates(["edgeState:selected","edgeState:hover"])}))}})}(e)};function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z={ball:{run:function(e){var t=e.get("children")[0],n=t.get("endArrowShape"),a=n&&n.get("bbox")?Math.max(n.get("bbox").width,n.get("bbox").height):0,o=t.getPoint(0),r=t.getTotalLength(),i=Math.floor(r/100)||1;if(!(r<=40))for(var s=0;s<i;s++){var l=setTimeout((function(){var n=e.addShape("circle",{attrs:{x:o.x,y:o.y,fill:"#1890ff",r:2},className:"edge-runner",name:"edge-runner"});n.animate((function(e){var o=t.getPoint(e),i=r-r*e>=a?1:0;return n.set("hasChanged",!1),I(I({},o),{},{opacity:i})}),{duration:r>=100?3*r:5*r,repeat:!0})}),s*r);e.runners.push(l)}},stop:function(e){var t=[];e.get("children").forEach((function(e){"edge-runner"===e.get("className")&&(e.stopAnimate(),t.push(e))})),t.forEach((function(e){return e.remove()})),e.runners.forEach((function(e){clearTimeout(e)})),e.running=!1}},dash:{run:function(e){var t=0,n=e.get("children")[0];e.addShape("path",{attrs:{offset:n.attrs.offset,path:n.attrs.path,stroke:"#fff",startArrow:!1,endArrow:!1},name:"edge-dash"}).animate((function(e){return++t>9&&(t=0),{lineDash:[2,1,2,4],lineDashOffset:-t}}),{repeat:!0,duration:3e3})},stop:function(e){var t=e.get("children").find((function(e){return"edge-dash"===e.cfg.name}));t&&(t.remove(),e.running=!1)}}};function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function H(e,t){t.running=!1,t.runners=[];var n=Object.assign({},this.getShapeStyle(e),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.edgeStateStyles));return t.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:n})}function K(e,t,n){var a=n.getContainer();a.get("destroyed")||(["edgeState","edgeState:default","edgeState:selected","edgeState:hover"].includes(e)?d[e].call(this,t,a):this.stateApplying&&this.stateApplying.call(this,e,t,n))}function R(e,t){e.running||(e.running=!0,e.toFront(),z[t].run.call(this,e))}function q(e,t){z[t].stop.call(this,e)}var X=function(e){["line","polyline","quadratic","cubic","arc"].forEach((function(t){!function(e,t){e.registerEdge("".concat(t,"-edge"),{drawShape:H,setState:K,runAnimate:R,stopAnimate:q},t)}(e,t)})),function(e,t){e.registerEdge("hvh-edge",$({draw:function(e,t){var n=e.startPoint,a=e.endPoint,o=a.y-n.y,r={x:n.x,y:a.y},i=0===o?[["M",n.x,n.y],["L",a.x,a.y]]:[["M",n.x,n.y],["L",n.x+40,n.y],["L",r.x+40,a.y>n.y?r.y-10:r.y+10],["Q",r.x+40,r.y,r.x+40+10,r.y],["L",a.x,a.y]],s=e.sourceNode.getModel().edgeStyle,l=t.addShape("path",{attrs:$($({path:i,stroke:"#1890FF",endArrow:!1},e.style),s),name:"hvh-edge",draggable:!0}),d=e.targetMode.getModel().note;if(d){var c=t.addShape("text",{attrs:{x:r.x+40+10,y:a.y-30,autoRotate:!0,text:d||"",fill:"#333",stroke:"#fff",fontSize:16},zIndex:10});t.sort(),c.toFront()}return l}},t))}(e,{drawShape:H,setState:K,runAnimate:R,stopAnimate:q}),function(e,t){e.registerEdge("hvh-h-edge",W({draw:function(e,t){var n=e.startPoint,a=e.endPoint,o=a.y-n.y,r={x:n.x,y:a.y},i=n.x-a.x>0,s=0===o?[["M",n.x,n.y],["L",a.x,a.y]]:[["M",n.x,n.y],["L",i?n.x-40:n.x+40,n.y],["L",i?r.x-40:r.x+40,a.y>n.y?r.y-10:r.y+10],["Q",i?r.x-40:r.x+40,r.y,i?r.x-40-10:r.x+40+10,r.y],["L",a.x,a.y]],l=e.sourceNode.getModel().edgeStyle,d=t.addShape("path",{attrs:W(W({path:s,stroke:"#1890FF",endArrow:!1},e.style),l),name:"hvh-edge",draggable:!0}),c=e.targetNode.getModel().text;if(c){var h=t.addShape("text",{attrs:{x:r.x+40+10,y:a.y-30,text:c||"",fill:"#333",fontSize:16},name:"hvh-edge-label",zIndex:10});t.sort(),h.toFront()}return d}},t))}(e,{drawShape:H,setState:K,runAnimate:R,stopAnimate:q})};t.a=function(e,t){var n=Object.assign({container:"canvasPanel",width:window.innerWidth,height:window.innerHeight,fitViewPadding:20,animate:!0,animateCfg:{duration:500,easing:"easeLinear"},layout:{type:"dagre",nodesep:30,ranksep:30},modes:{default:["drag-canvas","canvas-event","delete-item","select-node","hover-node","drag-shadow-node","active-edge"]},defaultNode:{type:"rect-node",style:{radius:10}},defaultEdge:{type:"polyline-edge",style:{radius:6,offset:15,stroke:"#aab7c3",lineAppendWidth:10,endArrow:{path:"M 0,0 L 8,4 L 7,0 L 8,-4 Z",fill:"#aab7c3",stroke:"#aab7c3"}}},nodeStateStyles:{"nodeState:default":{fill:"#E7F7FE",stroke:"#1890FF"},"nodeState:hover":{fill:"#d5f1fd"},"nodeState:selected":{fill:"#caebf9",stroke:"#1890FF"}},edgeStateStyles:{"edgeState:default":{stroke:"#aab7c3",endArrow:{path:"M 0,0 L 8,4 L 7,0 L 8,-4 Z",fill:"#aab7c3",stroke:"#aab7c3"}},"edgeState:selected":{stroke:"#1890FF"},"edgeState:hover":{stroke:"#1890FF"}}},t),a="string"==typeof n.container?document.getElementById(n.container):n.container;return a&&(setTimeout((function(){for(var e=function(e){var t=a.children[e];if("CANVAS"===t.nodeName)return t.$id="".concat(n.container,"-canvas"),document.addEventListener("click",(function(e){t.setAttribute("isFocused",e.target.$id===t.$id)})),"break"},t=0;t<a.children.length;t++){if("break"===e(t))break}})),function(e){M(e),F(e),X(e)}(e)),n}}}]);